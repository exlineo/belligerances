<header>
  <h1>{{ l.t['BATAILLES'] }}</h1>
  <p>{{ l.t['BATAILLES_DESCR'] }}</p>
</header>
<section id="champ" cdkDropListGroup>
  <header>

  </header>
  <!-- <article class="map tokens" onDragBoundary="map" #map cdkDrop watchDomTree (dom-changed)="setDragDOMPosition($event)"> -->
  <article class="map tokens" onDragBoundary="map" cdkDrop #map>  
    @for(c of listeCompagnies; track c.id){
    <div [matTooltip]="c.nom" class="token compagnie" cdkDrag [id]="'c'+c.id" #token>
      <img [src]="c.avatar" [alt]="c.nom">
      <span class="hex" [style.color]="d.armees[c.armee!].couleur">&#x2B22;</span>
    </div>
    }
    <div id="hexagones" [style.opacity]="opacite"></div>
  </article>
  <footer>
    <article><p>{{ l.t['HEX_AFFICHE'] }}</p>
    <mat-slider min="0" max="100" step="1" discrete (input)="matSlide($event)">
      <input matSliderThumb value="50">
    </mat-slider>
  </article>
  </footer>
  <!-- OPTION LATTERALES -->

</section>
<aside>
  <section [@tabOuvre]="tabArmees ? 'ferme' : 'ouvre'">
    <header>
      <a (click)="tabArmees = !tabArmees">
        <img src="assets/images/pictos/armoiries.png" [alt]="l.t['ARMEES']">
        <p>{{ l.t['ARMEES'] }}</p>
      </a>
    </header>
    <mat-accordion>
      @for(a of d.armees; track a.id; let i=$index){
      <mat-expansion-panel [class]="drag ? 'overflow' : ''">
        <mat-expansion-panel-header>
          <mat-panel-title>
            @if(a.avatar){
            <img [src]="a.avatar" [alt]="a.nom" class="avatar">
            }
            <h5>{{ a.nom }}</h5>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <article class="col panneau">
          <p>{{ a.descr }}</p>
          @for(c of a.compagnies; track c; let j=$index){
          <div>
            <div class="token" cdkDrag (cdkDragEnded)="tokenDrop($event, d.compagnies[c])" (cdkDragMoved)="setDragOverflow()"
              [matTooltip]="d.compagnies[c].nom">
              <img [src]="d.compagnies[c].avatar" [alt]="d.compagnies[c].nom">
              <span class="hex" [style.color]="a.couleur">&#x2B22;</span>
            </div>
            <div>
              <h5>{{ d.compagnies[c].nom }}</h5>
              <p>{{ l.t['UNITES'] }} : {{ d.compagnies[c].unites.length }}</p>
            </div>
          </div>
          }
        </article>
      </mat-expansion-panel>
      }
    </mat-accordion>
  </section>
  <section [@tabOuvre]="tabActions ? 'ferme' : 'ouvre'">
    <header>
      <a (click)="tabActions = !tabActions">
        <img src="assets/images/pictos/action.png" [alt]="l.t['ACTIONS']">
        <p>{{ l.t['ACTIONS'] }}</p>
      </a>
    </header>
  </section>
</aside>
